<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Challenge:
Bring it on! Show me EVERYTHING you’ve got! I want to see all you&rsquo;ve got!
Before starting with the writeup, the idea for solving this challenge came from my colleague Markel, kudos to him and make sure to check out his page!
We have the classic pawn scenario, a binary with a network connection.
If we download the binary and execute it we encounter the following:

After being asked two times the same question a segmentation fault happens.
Lets now decompile the code and see what all this is about.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://pablo10diez2.github.io/docs/writeups/0xfunctf/whatyouhave/">
  <meta property="og:site_name" content="Pablo Díez">
  <meta property="og:title" content="What you have">
  <meta property="og:description" content="Challenge: Bring it on! Show me EVERYTHING you’ve got! I want to see all you’ve got!
Before starting with the writeup, the idea for solving this challenge came from my colleague Markel, kudos to him and make sure to check out his page!
We have the classic pawn scenario, a binary with a network connection.
If we download the binary and execute it we encounter the following:
After being asked two times the same question a segmentation fault happens. Lets now decompile the code and see what all this is about.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2025-07-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-14T00:00:00+00:00">
    <meta property="article:tag" content="Exploitation">
    <meta property="article:tag" content="Gdb">
<title>[pwn] What you have | Pablo Díez</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://pablo10diez2.github.io/docs/writeups/0xfunctf/whatyouhave/">
<link rel="stylesheet" href="/book.min.e6c70d4d85c4e622658404043204b37e3a40e7c5f583acf3aa703e4adef31fb3.css" integrity="sha256-5scNTYXE5iJlhAQEMgSzfjpA58X1g6zzqnA&#43;St7zH7M=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.8fe47bcedcba5932e4a9a075e2aa043148c58ba1d4fc243e8d0a3b89ff5e7f69.js" integrity="sha256-j&#43;R7zty6WTLkqaB14qoEMUjFi6HU/CQ&#43;jQo7if9ef2k=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr" class="book-kind-page book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Pablo Díez</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Projects</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/projects/fluid/" class="">Fluid Simulation SPH</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/projects/lepicasso/" class="">Le-Picasso</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Writeups</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <span>0xfun Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/0xfunctf/whatyouhave/" class="active">[pwn] What you have</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>L3ak Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/l3akctf/basiclll/" class="">[crypto] BasicLLL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/l3akctf/shirohero/" class="">[crypto] Shiro Hero</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Dawg Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/64-bits/" class="">[reversing] 64 bits in my ark and texture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/baby-rsa2/" class="">[crypto] Baby-RSA 2</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/cantorspairadox/" class="">[crypto] Cantors Pairadox</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>[pwn] What you have</h3>

  <label for="toc-control">
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents"></nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><p>Challenge:
<strong>Bring it on! Show me EVERYTHING you’ve got! I want to see all you&rsquo;ve got!</strong></p>
<p>Before starting with the writeup, the idea for solving this challenge came from my colleague <a href="https://markelmencia.com/">Markel</a>, kudos to him and make sure to check out his page!</p>
<p>We have the classic pawn scenario, a binary with a network connection.</p>
<p>If we download the binary and execute it we encounter the following:</p>
<p><img src="/images/fun1.png" alt="Output" /></p>
<p>After being asked two times the same question a segmentation fault happens.
Lets now decompile the code and see what all this is about.</p>
<p>Using dogbolt we can see the following functions. The first one is main, where we are asked to introduce two inputs (line 246 and 248). The other one is win, where it opens a file and reads the flag. With this we can assume that somehow we will need to jump to the win function and we will have the flag.</p>
<p><img src="/images/fun2.png" alt="main" /></p>
<p><img src="/images/fun3.png" alt="win" /></p>
<p>The first thing to look for when using scanf is for a classic buffer overflow. This won&rsquo;t be possible to perform due to the stack canary being activated. The canary is a security mechanism to prevent overflows. It works like this: a variable is located right before the return address (remember that the stack goes downwards) and initialized with an unkown variable, if we want to overwrite that with an overflow we would eventually have to also change the value of the canary. Right before returning to another function the program compares the initial value of the canary with the current one, if it&rsquo;s not the same it won&rsquo;t jump. So we will need to be a little bit more precise.</p>
<p>Now in order to take a closer look into the registers I will open the binary with the tool Cutter. And if we go to the main function we can actually see whats happening.</p>
<p>Lets refresh our memory on how scanf and x86-64 works. The scanf function takes a format specifier as it&rsquo;s first argument and the address where the value is going to be stored as the second one. The other thing that we need to know is that the first argument of a function call is passed through the RDI register and the second one through the RSI one. So if we look at what address is stored inside the RSI register we can determine where are this values stored.</p>
<p>Looking at the first 2 arrows we can see the name of the variables, its address is stored in RAX and then moved to RSI. And it doesn&rsquo;t stop there, the last 3 arrows show how inside the first scanf value is stored the second one! (You can see the same in the first screenshot, the dogbolt decompile)</p>
<p><img src="/images/fun4.png" alt="cutter" /></p>
<p>This means that we can send whatever address we want in the first scanf call and set the value we want to be stored there with the second one.</p>
<p>Now the final solution. If we execute <code>checksec --file=./chall</code> in our terminal we can see that the PIE is off. The PIE or Position Inedependent Executables option makes the location of the code not randomized. This means that there are some addresses that will be the same no matter where we execute the file or how many times.</p>
<p>If we take another look into the main function we can see that there is a third put that prints something. The binary has something calle the GOT, Global Offset Table, this holds the addresses of the dinamically linked libraries. We could search for the put address in this table and overwrite it with our win function. So when the program executes the last put it will actually be giving us the flag.</p>
<p>To perform this we need the address of win, and the address of where the put function address is stored, so we just write this two commands inside gdb (I have the pwn extension).</p>
<p><img src="/images/fun5.png" alt="gdb" /></p>
<p>The put address is stored in 0x403430 and the address of win is 0x401236. We just need to assemble the python script, that will looks something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chall.0xfun.org&#34;</span>, <span style="color:#ae81ff">41607</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GOT_PUT <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x403430</span>
</span></span><span style="display:flex;"><span>WIN_ADDRESS <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401236</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, str(GOT_PUT)<span style="color:#f92672">.</span>encode() )
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, str(WIN_ADDRESS)<span style="color:#f92672">.</span>encode() )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p><code>0xfun{g3tt1ng_schw1fty_w1th_g0t_0v3rwr1t3s_1384311_m4x1m4l}</code></p>
</article>
 
      <div style="text-align: center; margin-top: 3rem; padding-top: 1rem; border-top: 1px solid var(--gray-200);">
  <a href="https://www.linkedin.com/in/pablodíez/" target="_blank" rel="noopener">LinkedIn</a>
  &nbsp;&nbsp;•&nbsp;&nbsp;
  <a href="mailto:pablodiezruiz111@gmail.com">Mail</a>
  &nbsp;&nbsp;•&nbsp;&nbsp;
  <a href="https://github.com/pablo10diez2" target="_blank" rel="noopener">GitHub</a>
</div>


      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/projects/lepicasso/" class="flex align-center book-icon">
        <img src="/svg/backward.svg" class="book-icon" alt="Previous" title="Le-Picasso" />
        <span>Le-Picasso</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/writeups/l3akctf/basiclll/" class="flex align-center book-icon">
        <span>[crypto] BasicLLL</span>
        <img src="/svg/forward.svg" class="book-icon" alt="Next" title="[crypto] BasicLLL" />
      </a>
    
    </span>
  </div>
  




  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 
      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

 
  </main>

  
</body>
</html>

















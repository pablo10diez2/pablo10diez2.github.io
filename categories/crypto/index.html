<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://pablo10diez2.github.io/categories/crypto/">
  <meta property="og:site_name" content="Pablo Díez">
  <meta property="og:title" content="Crypto">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="website">
<title>Crypto | Pablo Díez</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://pablo10diez2.github.io/categories/crypto/">
<link rel="stylesheet" href="/book.min.e6c70d4d85c4e622658404043204b37e3a40e7c5f583acf3aa703e4adef31fb3.css" integrity="sha256-5scNTYXE5iJlhAQEMgSzfjpA58X1g6zzqnA&#43;St7zH7M=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.8fe47bcedcba5932e4a9a075e2aa043148c58ba1d4fc243e8d0a3b89ff5e7f69.js" integrity="sha256-j&#43;R7zty6WTLkqaB14qoEMUjFi6HU/CQ&#43;jQo7if9ef2k=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://pablo10diez2.github.io/categories/crypto/index.xml" title="Pablo Díez" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr" class="book-kind-term book-type-categories">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Pablo Díez</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Projects</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/projects/fluid/" class="">Fluid Simulation SPH</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/projects/lepicasso/" class="">Le-Picasso</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Writeups</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <span>0xfun Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/0xfunctf/whatyouhave/" class="">[pwn] What you have</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>L3ak Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/l3akctf/basiclll/" class="">[crypto] BasicLLL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/l3akctf/shirohero/" class="">[crypto] Shiro Hero</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Dawg Ctf</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/64-bits/" class="">[reversing] 64 bits in my ark and texture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/baby-rsa2/" class="">[crypto] Baby-RSA 2</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/dawgctf/cantorspairadox/" class="">[crypto] Cantors Pairadox</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Crypto</h3>

  <label for="toc-control">
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <span>Categories</span>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/crypto/">Crypto</a>
          <span>4</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/pwn/">Pwn</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/categories/reversing/">Reversing</a>
          <span>1</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <span>Tags</span>
      <ul>
      
        <li class="flex justify-between">
          <a href="/tags/buffer-overflow/">Buffer Overflow</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/crypto/">Crypto</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/exploitation/">Exploitation</a>
          <span>3</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/gdb/">Gdb</a>
          <span>3</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/math/">Math</a>
          <span>3</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/cantor/">Cantor</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/cryptography/">Cryptography</a>
          <span>2</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/rsa/">Rsa</a>
          <span>1</span>
        </li>
      
      </ul>
    </li>
    
  
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/writeups/l3akctf/basiclll/">[crypto] BasicLLL</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>July 14, 2025</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/crypto/">Crypto</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/buffer-overflow/">Buffer Overflow</a>, 
      <a href="/tags/exploitation/">Exploitation</a>, 
      <a href="/tags/gdb/">Gdb</a>
  </div>
  


    <p><p>Challenge:
<strong>Simple crypto is the best crypto.</strong></p>
<p>For this crypto chall we have to download 1 file. A sage one.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate</span>():
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> random_prime(<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1024</span>, lbound<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1023</span>)
</span></span><span style="display:flex;"><span>    x<span style="color:#f92672">=</span>randint(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>    y<span style="color:#f92672">=</span>randint(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>    a<span style="color:#f92672">=</span>randint(<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1023</span>,<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>    q<span style="color:#f92672">=</span>random_prime(<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">1024</span>)
</span></span><span style="display:flex;"><span>    n<span style="color:#f92672">=</span>p<span style="color:#f92672">*</span>q
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x,a,y,n,p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x,a,y,n,p <span style="color:#f92672">=</span> generate()
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> x <span style="color:#f92672">*</span> y <span style="color:#f92672">+</span> a <span style="color:#f92672">*</span> p
</span></span><span style="display:flex;"><span>e<span style="color:#f92672">=</span><span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;x = </span><span style="color:#e6db74">{</span>x<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;a = </span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;n = </span><span style="color:#e6db74">{</span>n<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;k = </span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;L3AK{&lt;Redacted&gt;}&#39;</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(m, byteorder<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;big&#39;</span>)
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span> pow(flag, e, n)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c = </span><span style="color:#e6db74">{</span>c<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">x = 54203
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">a = 139534605978199350449870348663594126359773246906906418074945064315708552206952695156472923968554408862426942537522569163756593332601739006413404986641247624386522169136633429464195370373009454673819688653512479919153332504769835621608305089536245284458011218876474599059184828911301976396971466368457267831713
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">n = 12909957208634846878337953184362917609451224905637563117148705894888627434882610771803126452504238664471840340722310690445704139825753660053450331966698205860077330083433391290469454571152366284661640391190008258576947840075212180965738595761925516686689797153224716140447515370184846067654512660266993573880775530634588475842083212670090415716860925772115834314563453955681012820960922892736520042799257599331942717963921797157341454739255402633419216921702659541513141028779948257696746810146033667942181244847983610429227387863821351416689099862418820999250005071861968501333899759899513283613946626413863922604073
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">k = 24474689179117620559916890529357882261493825442019850679598519081287156822984032786458479363048845076078220151760752906879055457682971398809768604333650029141164831566127754715775782823279839766009120238777348170982471623193652714921064243946655726118484337862412275391615166714375745390409664610412156281691721978732319253694004232933156865189917761521085635692596755802274763409871937618659197646864593743015558828475450200247766980008744319676783526158213931581034209356092026748307730083927225249093712227456855972520574747646873074625455900058136458828591335711677741591552501530047335481073272381631524755666119
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">c = 11185314040721202177044508537272244264288033276739579716599246665772965854249656943282002695659011960313245796587834222078633141747802754149848079632693280265262199729548775879612614113828267471629389698999657686858047585254549801752634049341009476489652456620836030696102393122618822021082792763848220677651608135328630551380537642144416978955966827336280510774254681264136102268730343853559751471313539810499170669215479225898738527316798768622089152851154959800113070358637984124299357803777453137311143202502153552192970732744885328421213081964363890280109214401691255867427694709196120824176729643585687319321473
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span></code></pre></div><p>With just a simple look we can see that this is RSA. So once we are aware of that, we know that in order to decipher RSA we need d, the private key. If you don&rsquo;t understand or are not very familiar with RSA I would suggest checking this: <a href="https://www.geeksforgeeks.org/computer-networks/rsa-algorithm-cryptography/">https://www.geeksforgeeks.org/computer-networks/rsa-algorithm-cryptography/</a> , that will give you a brief summary in order to understand the following equations.</p></p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/writeups/l3akctf/shirohero/">[crypto] Shiro Hero</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>July 14, 2025</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/crypto/">Crypto</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/crypto/">Crypto</a>, 
      <a href="/tags/math/">Math</a>
  </div>
  


    <p><p>Challenge:</p>
<p>For this crypto chall we have to download 4 files, 3 of them are python scripts and the last one is just a text file.</p>
<p><strong>Chall.py</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> secrets <span style="color:#f92672">import</span> randbits
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> prng <span style="color:#f92672">import</span> xorshiro256
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.Padding <span style="color:#f92672">import</span> pad, unpad
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> ecc <span style="color:#f92672">import</span> ECDSA
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> bytes_to_long, long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;flag.txt&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>state <span style="color:#f92672">=</span> [randbits(<span style="color:#ae81ff">64</span>) <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>prng <span style="color:#f92672">=</span> xorshiro256(state)
</span></span><span style="display:flex;"><span>leaks <span style="color:#f92672">=</span> [prng<span style="color:#f92672">.</span>next_raw() <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;PRNG leaks: </span><span style="color:#e6db74">{</span>[hex(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> leaks]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>Apriv, Apub <span style="color:#f92672">=</span> ECDSA<span style="color:#f92672">.</span>gen_keypair()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;public_key = </span><span style="color:#e6db74">{</span>Apub<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;My favorite number is 0x69. I&#39;m a hero in your mother&#39;s bedroom, I&#39;m a hero in your father&#39;s eyes. What am I?&#34;</span>
</span></span><span style="display:flex;"><span>H <span style="color:#f92672">=</span> bytes_to_long(msg)
</span></span><span style="display:flex;"><span>sig <span style="color:#f92672">=</span> ECDSA<span style="color:#f92672">.</span>ecdsa_sign(H, Apriv, prng)                  
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Message = </span><span style="color:#e6db74">{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Hash = </span><span style="color:#e6db74">{</span>H<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;r, s = </span><span style="color:#e6db74">{</span>sig<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha256(long_to_bytes(Apriv))<span style="color:#f92672">.</span>digest()
</span></span><span style="display:flex;"><span>iv <span style="color:#f92672">=</span> randbits(<span style="color:#ae81ff">128</span>)<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;big&#34;</span>)
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_CBC, iv)
</span></span><span style="display:flex;"><span>ciphertext <span style="color:#f92672">=</span> iv<span style="color:#f92672">.</span>hex() <span style="color:#f92672">+</span> cipher<span style="color:#f92672">.</span>encrypt(pad(flag, <span style="color:#ae81ff">16</span>))<span style="color:#f92672">.</span>hex()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ciphertext = </span><span style="color:#e6db74">{</span>ciphertext<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;output.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;PRNG leaks: </span><span style="color:#e6db74">{</span>[hex(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> leaks]<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;public_key = </span><span style="color:#e6db74">{</span>Apub<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Message = </span><span style="color:#e6db74">{</span>msg<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Hash = </span><span style="color:#e6db74">{</span>H<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;r, s = </span><span style="color:#e6db74">{</span>sig<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ciphertext = </span><span style="color:#e6db74">{</span>ciphertext<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p><strong>ecc.py</strong></p></p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/writeups/dawgctf/baby-rsa2/">[crypto] Baby-RSA 2</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>April 19, 2025</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/crypto/">Crypto</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/rsa/">Rsa</a>, 
      <a href="/tags/cryptography/">Cryptography</a>, 
      <a href="/tags/math/">Math</a>
  </div>
  


    <p><p>Challenge:
<strong>If all I have to do is keep my factors p and q secret, then I can save</strong>
<strong>computation time by sharing the same modulus between all my friends. I&rsquo;ll</strong>
<strong>give them unique e and d pairs to encrypt and decrypt messages. Sounds secure to me!</strong></p>
<p>For this we are given 2 files. The first one is a .py and the second one what prints.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> secret <span style="color:#f92672">import</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is my stuff! Don&#39;t look at it</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">512</span>)
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> p <span style="color:#f92672">*</span> q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e_priv <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10001</span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d_priv <span style="color:#f92672">=</span> inverse(e_priv, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> bytes_to_long(flag)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> pow(m, e_priv, N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This is your stuff!</span>
</span></span><span style="display:flex;"><span>e_pub <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>d_pub <span style="color:#f92672">=</span> inverse(e_pub, phi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;e = </span><span style="color:#e6db74">{</span>e_pub<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;d = </span><span style="color:#e6db74">{</span>d_pub<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;N = </span><span style="color:#e6db74">{</span>N<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;c = </span><span style="color:#e6db74">{</span>c<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p><strong>e = 58271</strong>
<strong>d =</strong> <strong>16314065939355844497428646964774413938010062495984944007868244761330321449198604198404787327825341236658059256072790190934480082681534717838850610633320375625893501985237981407305284860652632590435055933317638416556532857376955427517397962124909869006289022084571993305966362498048396739334756594170449299859</strong>
<strong>N =</strong> <strong>11908266771291549727040770227788674365298563844463718805993868100807705889593534576540716051355511201319075171121352338919492532856516466781757032847478539199285763483256</strong>
<strong>2389502866385475392702847788337877472422435555825872297998602400341624700149407637506713864175123267515579305109471947679940924817268027249</strong>
<strong>c =</strong> <strong>1070895821540922853545147589874651120161444554801263669629104142937219656827406742051002228234391509902999896805931793509330204277323867163866850522216802742834694813501</strong>
<strong>06415150660410528574034324184318354089504379956162660478769613136499331243363223860893663583161020156316072996007464894397755058410931262938</strong></p></p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/writeups/dawgctf/cantorspairadox/">[crypto] Cantors Pairadox</a>
    </h2>
    
  <div class="flex align-center text-small book-post-date">
    <img src="/svg/calendar.svg" class="book-icon " alt="" />
    <span>April 19, 2025</span>
  </div>



  
  <div class="text-small">
    
      <a href="/categories/crypto/">Crypto</a>
  </div>
  

  
  <div class="text-small">
    
      <a href="/tags/cantor/">Cantor</a>, 
      <a href="/tags/cryptography/">Cryptography</a>, 
      <a href="/tags/math/">Math</a>
  </div>
  


    <p><p>Challenge:
<strong>Now that I have encrypted my flag with a new math function</strong>
<strong>I was just researching I can know share it with my friend Cantor</strong>
<strong>and no one will know how to read it except us!</strong></p>
<p>For this we are given 2 files. The first one is a .txt containing
the following:</p>
<p><strong>flag = 4036872197130975885183239290191447112180924008343518098638033545
53589334888434826276681036070738374179472139222629149731482620127084778
4737584016</strong></p>
<p>And the other one is a python file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sage.all <span style="color:#f92672">import</span> sqrt, floor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> secret <span style="color:#f92672">import</span> flag
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getTriNumber</span>(n):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> n <span style="color:#f92672">*</span> (n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>  <span style="color:#75715e"># Ensure integer division</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pair</span>(n1, n2):
</span></span><span style="display:flex;"><span>    S <span style="color:#f92672">=</span> n1 <span style="color:#f92672">+</span> n2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> getTriNumber(S) <span style="color:#f92672">+</span> n2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pair_array</span>(arr):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(arr), <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        result<span style="color:#f92672">.</span>append(pair(arr[i], arr[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]))    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pad_to_power_of_two</span>(arr):
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> arr
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> len(result)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (n <span style="color:#f92672">&amp;</span> (n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        result<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        n <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [ord(f) <span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> flag]  
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> pad_to_power_of_two(flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>temp <span style="color:#f92672">=</span> flag
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>):
</span></span><span style="display:flex;"><span>    temp <span style="color:#f92672">=</span> pair_array(temp)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Encoded:&#34;</span>, temp)
</span></span></code></pre></div><p>Lets start by analizing what it does.</p></p>
  </article>
  

  
 
      <div style="text-align: center; margin-top: 3rem; padding-top: 1rem; border-top: 1px solid var(--gray-200);">
  <a href="https://www.linkedin.com/in/pablodíez/" target="_blank" rel="noopener">LinkedIn</a>
  &nbsp;&nbsp;•&nbsp;&nbsp;
  <a href="mailto:pablodiezruiz111@gmail.com">Mail</a>
  &nbsp;&nbsp;•&nbsp;&nbsp;
  <a href="https://github.com/pablo10diez2" target="_blank" rel="noopener">GitHub</a>
</div>


      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>





  
  
  




  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 
      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    

 
  </main>

  
</body>
</html>
















